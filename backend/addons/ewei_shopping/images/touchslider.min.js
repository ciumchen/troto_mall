!function(t,e){window.touchSlider=function(n){function i(t){x.removeClass(n.currentClass).eq(t).addClass(n.currentClass)}function o(t,n){var i=m.current;i!==t&&(t=t!==e?t:i+1,k.to(t,{complete:n}))}function r(t){k.to(m.current+1,{dirX:1,complete:t})}function a(t){k.to(m.current-1,{dirX:-1,complete:t})}function u(){W&&s()}function s(){return W=!0,C||(clearTimeout(y),y=setTimeout(function(){!k.moving&&!C&&r()},n.delay)),n.container}function c(){return clearTimeout(y),W=!1,n.container}function h(){var e,n,i,o,r,a,u,s,c,h,l,m,w,x=t(document),S=!1,T=function(t){return t.which>1?void 0:(S&&x.triggerHandler(v+"."+f),S=!0,n=!1,e=t.timeStamp,u=m=0,i=[0,0,0,e],t.originalEvent.touches?void x.one(d,y):(t.preventDefault(),r=a=t.pageX,h=l=t.pageY,c=M[0].offsetLeft,o=[0,0,0,r],x.bind(g,C),x.one(v+"."+f,W),k.moveStart(t),void 0))},y=function(t){1===t.originalEvent.touches.length&&(r=a=t.pageX=t.originalEvent.touches[0].pageX,h=l=t.pageY=t.originalEvent.touches[0].pageY,s=w=0,c=new WebKitCSSMatrix(window.getComputedStyle(M[0]).webkitTransform).e,o=[0,0,0,r],x.bind(g,C),x.one(v,W),k.moveStart(t))},C=function(e){var r,c;if(e.originalEvent.touches&&p){if(1!==e.originalEvent.touches.length)return;if(r=e.pageX=e.originalEvent.touches[0].pageX,c=e.pageY=e.originalEvent.touches[0].pageY,s+=Math.abs(r-a),w+=Math.abs(c-l),Math.abs(s-w)>50){var h=s;s=Math.min(100,Math.max(0,s-w)),w=Math.min(100,Math.max(0,w-h))}if(r===a)return;n||(s>w?(e.preventDefault(),n=!0):W(e))}else{if(r=e.pageX,c=e.pageY,r===a)return;t.browser.msie&&e.preventDefault()}u+=Math.abs(r-a),m+=Math.abs(c-l),i.shift(),i.push(e.timeStamp),o.shift(),o.push(r),k.move(e,a),a=r,l=c},W=function(t){S=!1,(!t.originalEvent||t.originalEvent.touches)&&(t.pageX=a,t.pageY=l),x.unbind(g,C);for(var n=i.length,r=0,s=0;--n>0;)if(i[n-1]){var c=o[n]-o[n-1];r+=Math.abs(c)/(i[n]-i[n-1]),0!==c&&(s=c>0?-1:1)}r/=i.length,k.moveEnd(t,r,s,e,u,m),q=!1,u+m>4&&b.one("click",function(t){t.preventDefault()})};b.bind(d,T)}n=n||{};var f=n.namespace||"touchslider",l=t(n.container);if(1!==l.length)return void l.each(function(){touchSlider({container:this})});n=t.extend({autoplay:!1,delay:3e3,margin:5,viewport:"."+f+"-viewport",prev:"."+f+"-prev",next:"."+f+"-next",pagination:"."+f+"-nav-item",currentClass:f+"-nav-item-current",duration:350,mouseTouch:!0},n);var m={current:0,step:o,next:r,prev:a,start:s,stop:c},p="ontouchstart"in window&&"WebKitCSSMatrix"in window,d="touchstart",g="touchmove",v="touchend",b=t(n.viewport,l),M=n.scroller?t(n.scroller,l):b.children(),w=M.children(),x=t(n.pagination,l);if("absolute"!==M.css("position")){var S=b.height();b.css({height:S,position:"relative"}),M.css({position:"absolute",left:0,height:S,width:1e5})}p||(d="mousedown",g="mousemove",v="mouseup"),w.css("position","absolute");var T=p?function(t,n,i){return n===e?new WebKitCSSMatrix(getComputedStyle(t.jquery?t[0]:t).webkitTransform).e:void t.css({webkitTransitionDuration:i?i+"ms":"0",webkitTransform:function(t){return"translate3d("+("number"==typeof n?n:n.call(this,t))+"px,0,0)"}})}:function(t,n){return n===e?parseInt((t.jquery?t[0]:t).style.left,10):void t.css("left",n)};p&&w.css({webkitTransitionProperty:"-webkit-transform",webkitTransitionTimingFunction:"cubic-bezier(0,0,0.25,1)"}),T(w.not(w[0]),1e4),T(w.eq(0),0);var k=function(){var o=[0],r=[0],a=t.noop;return{moving:!1,init:function(){M.bind("webkitTransitionEnd",function(){a()})},to:function(s,c){c=c||{},s>=w.length?s=0:0>s&&(s=w.length-1);var h=n.duration,f=w.eq(s),l=t.inArray(s,o),d=0;if(M.stop(),k.moving=!0,clearTimeout(y),-1!==l)d=r[l];else{var g,v=w.index(f);if(l=e,-1===c.dirX)r.unshift(0),o.unshift(v);else if(1===c.dirX)r.push(0),o.push(v);else{for(g=o.length-1;g>=0;g--)if(o[g]<v){r.splice(g+1,0,0),o.splice(g+1,0,v),l=0;break}l===e&&(r.unshift(r),o.unshift(v))}if(l=t.inArray(v,o),0===l)d=r[1]-(f.outerWidth()+n.margin),T(f,d),r[l]=d;else if(l===o.length-1)d=r[l-1]+w.eq(o[l-1]).outerWidth()+n.margin,T(f,d),r[l]=d;else{var b=f.outerWidth();f.css("opacity",0),d=r[l+1]-Math.round((b+n.margin)/2),r[l]=d,T(f,d);var x=d,S=o.length;for(g=l-1;g>=0;g--)x-=w.eq(o[g]).outerWidth()+n.margin,r[g]=x;var q=d;for(g=l+1;S>g;g++)q+=w.eq(o[g]).outerWidth()+n.margin,r[g]=q;for(g=0;S>g;g++)w.eq(o[g]).animate({left:r[g]},{duration:h,queue:!1,complete:function(){f.is(this)&&f.animate({opacity:1},h)}})}}c.pxInMs&&(h=Math.min(Math.max(Math.round(Math.abs(T(M))/c.pxInMs),100),h)),a=function(){T(w.not(f),-1e4),o=[w.index(f)],r=[d],c.complete&&c.complete(),k.moving=!1,u()},p?T(M,-d,h):M.animate({left:-d},{duration:h,queue:!1,complete:a}),m.current=s,i(s)},stop:function(){p?T(M,T(M)):M.stop()},moveStart:function(t){k.moving=!0,clearTimeout(y),M.stop(),k.startPageX=t.pageX;var e,n=T(M);k.leftCount=n,0===o[0]?r[0]+n>0&&(k.leftCount=n+3*(r[0]+n)):o[o.length-1]===w.length-1&&(e=r[o.length-1]+n,0>e&&(k.leftCount=n+3*e))},move:function(t,e){var i,a,u,s=t.pageX-e,c=T(M),h=w.eq(o[0]),f=o.length-1,l=w.eq(o[f]);if(k.leftCount+=s,s>0)for(;0!==o[0]&&c+r[0]+s>n.margin;)i=w.eq(o[0]-1),a=r[0]-i.outerWidth()-n.margin,T(i,a),r.unshift(a),o.unshift(o[0]-1),f++,h=i;if((s>0&&c+r[0]+s>0||0>s&&c+r[0]>0)&&0===o[0]&&(u=Math.min(Math.round((k.leftCount+r[0])/4),b.innerWidth()/2),s=u-(c+r[0])),0>s)for(;!l.is(w.last())&&c+r[f]+s+l.outerWidth()+n.margin<b.innerWidth();)i=w.eq(o[f]+1),a=r[f]+l.outerWidth()+n.margin,T(i,a),r.push(a),o.push(o[f++]+1),l=i;(s>0&&c+r[f]<0||0>s&&c+r[f]+s<0)&&l.is(w.last())&&(u=Math.max(Math.round((k.leftCount+r[f])/4),-b.innerWidth()/2),s=u-(c+r[f])),T(M,c+s)},moveEnd:function(t,e,n,i,a,u){var s,c=o.length,h=T(M),f=c-1;if(r[0]+h>0)f=0;else if(!(r[o.length-1]+h<0)){s={pxInMs:e};var l,m,p=c-1,d=b.innerWidth();for(l=0;c-1>l;l++)if(m=r[l]+w.eq(o[l]).outerWidth()+h,m>0&&m>d-(r[l+1]+h)){p=l;break}if(q)f=p;else{var g=c-1,v=Math.round(M.offset().left);for(l=0;c>l;l++)if(r[l]+v>t.pageX){g=l-1;break}f=p,p===g&&t.timeStamp-i<1e3&&a+u>.05*Math.sqrt(Math.pow(b.height(),2)+Math.pow(d,2))&&(f=Math.max(0,Math.min(c-1,f+n)))}}f=o[f],k.to(f,s)}}}();if(k.init(),p){var q=!1;M.bind("webkitTransitionStart",function(){q=!0}),M.bind("webkitTransitionEnd",function(){q=!1})}var y,C=!1,W=!1;b.hover(function(){clearTimeout(y),C=!0},function(){C=!1,u()}),x.click(function(){o(x.index(this))}),t(n.prev,l).click(function(){a()}),t(n.next,l).click(function(){r()}),n.mouseTouch&&h(),n.autoplay&&s(),l.data(f,m)},t.fn.touchSlider=function(t){return t=t||{},t.container=this,touchSlider(t),this}}(jQuery);