!function(t,s){function i(t,s,i){t.addEventListener?t.addEventListener(s,i,!1):t.attachEvent("on"+s,i)}function e(t,s,i){t.removeEventListener?t.removeEventListener(s,i,!1):t.detachEvent("on"+s,i)}function a(t){this.el=t.el,this.imgSrc=t.imgSrc,this.delay=t.delay,this.imgs=this.el.getElementsByTagName("img"),this.len=this.imgs.length,this.h=parseInt(document.documentElement.clientHeight||document.body.clientHeight),this.last=!1,this.curIndex=0,this.nav=t.nav,this.con=t.con,this.load=t.load,this.recom=t.recom,this.url=t.url,this.on=t.on,this.nogoods=t.nogoods,this._top=parseInt(this.nav.offset().top),this.pcate=1,this.page=1,this.flag=!1,this.scrFlag=!1,this.fn="",this.dataArr=[]}a.prototype={constructor:a,loadImg:function(t){var s,i,e;for(this.scrTop=parseInt(document.documentElement.scrollTop||document.body.scrollTop),s=this.curIndex;s<this.len;s++)if(i=this.imgs[s],i&&(e=parseInt(i.getBoundingClientRect().top),e+this.scrTop<this.h+this.scrTop+100)){this.curIndex=s;try{i.getAttribute(this.imgSrc)&&(i.setAttribute("src",i.getAttribute(this.imgSrc)),i.removeAttribute(this.imgSrc))}catch(a){}s==this.len-1&&(this.last=!0,clearTimeout(this.timer))}this.first=!1},scrollLoadData:function(s,i,a,o){var n=this;$.ajax({type:"post",url:n.url,data:{pcate:s,page:i},dataType:"json",success:function(s){200==s.status?(s.obj.length>0&&1!=n.pcate&&1==n.page&&(n.dataArr[n.pcate]=s),a&&a(s)):-200==s.status&&(n.load.hide(),n.nogoods.show(),""!=o&&e(t,"scroll",o)),n.scrFlag=!1}})},showPageData:function(t){var s="",i="";if(0!=t.obj.length){for(var t=t.obj,e=0,a=t.length;a>e;e++){for(var o=t[e],n=0,l=o.list.length;l>n;n++){var c=o.list[n],h="";0!=c.top&&(h='<div class="product-top class-top">TOP<i></i></div>'),i+='<li>							<a href="'+c.link+'">								'+h+'								<img src="'+c.thumb+'" alt="'+c.title+'" />								<h3>'+c.title+"</h3>								<p>￥"+c.price+"</p>							</a>						</li>"}s+='<div class="index-class-list">						<div class="box-shadow class-list-title">							<h2><i class="title-left"></i>'+o.title+'<i class="title-right"></i></h2>							<p><i class="title-line-left"></i>'+o.desc+'<i class="title-line-right"></i></p>						</div>						<ul class="class-list-con">'+i+'</ul>						<div class="bottom-load-more">							<a href="'+o.morelink+'" class="load-more-btn">查看更多</a>							<span>Click for more products</span>							<a href="'+o.morelink+'" class="load-more-txt">点击进入</a>						</div>					</div>'}1!=this.pcate&&1!=this.page?this.con.find(".class-list-con").append(i):this.con.append(s),this.flag&&this.addScrollFun()}},scrollFixed:function(){var t=this;$(document).on("scroll",function(){t.fixedTab()})},fixedTab:function(){var t=parseInt(document.documentElement.scrollTop||document.body.scrollTop);this._top<t+10?(this.nav.addClass(this.on),this.con.addClass(this.on)):(this.nav.removeClass(this.on),this.con.removeClass(this.on))},navTab:function(){var s=this;this.nav.find("li").on("click",function(i){i.stopPropagation();var a=$(this);a.addClass(s.on).siblings().removeClass(s.on),""!=s.fn&&(s.flag=!0,e(t,"scroll",s.fn)),s.page=1,s.pcate=a.attr("data-type"),s.load.show(),s.nogoods.hide(),s.con.find(".index-class-list").remove(),1==s.pcate?(s.recom.show(),s.addScrollFun()):(s.recom.hide(),s.dataArr[s.pcate]?s.showPageData(s.dataArr[s.pcate]):s.scrollLoadData(s.pcate,1,function(t){s.showPageData(t)},"")),setTimeout(function(){s.fixedTab()},50)})},addScrollFun:function(){var s=this;i(t,"scroll",function(t){s.fn=arguments.callee,1!=s.last?s.timer=setTimeout(function(){s.loadImg(s.fn)},s.delay):s.scrFlag||s.isNextPage()})},isNextPage:function(){var s=this;this.hei=parseInt($(document).height()),this.scrTop=parseInt($(t).scrollTop()),this.conHei=parseInt($(t).height()),this.hei-(this.scrTop+this.conHei)<110&&(this.scrFlag=!0,this.page++,this.scrollLoadData(this.pcate,this.page,function(t){s.showPageData(t)},this.fn))},init:function(){var s=this;this.loadImg(),this.addScrollFun(),this.isNextPage(),i(t,"resize",function(){s.h=parseInt(document.documentElement.clientHeight||document.body.clientHeight),s.loadImg()}),this.scrollFixed(),this.navTab()}},t.LazyLoad=a}(window);